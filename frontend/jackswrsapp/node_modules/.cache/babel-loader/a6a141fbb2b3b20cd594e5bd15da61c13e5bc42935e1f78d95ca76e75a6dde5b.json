{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import{useParams,Link}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function CustomerProfile(){const{id}=useParams();const[profile,setProfile]=useState(null);useEffect(()=>{const fetchProfile=async()=>{try{const res=await axios.get(`http://localhost:3001/api/customers/${id}/profile`);setProfile(res.data);}catch(err){console.error(err);}};fetchProfile();},[id]);if(!profile)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});const{customer,lastTransaction,sales}=profile;return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"h2\",{children:[customer.name,\" \",/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",style:{fontSize:'14px'},children:[\"Created: \",new Date(customer.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Last Transaction:\"}),\" \",lastTransaction?(()=>{const date=new Date(lastTransaction);const formattedDate=date.toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});const today=new Date();// Reset time to midnight for accurate day difference\ntoday.setHours(0,0,0,0);date.setHours(0,0,0,0);const diffTime=today-date;const diffDays=Math.round(diffTime/(1000*60*60*24));const daysAgo=diffDays===0?\"today\":`${diffDays} day${diffDays>1?'s':''} ago`;return`${formattedDate} (${daysAgo})`;})():'-']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Nickname:\"}),\" \",customer.nickname||'-']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Phone:\"}),\" \",customer.phone||'-']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Address:\"}),\" \",customer.address||'-']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Landmark:\"}),\" \",customer.landmark||'-']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Birthday:\"}),\" \",customer.birthday?new Date(customer.birthday).toLocaleDateString():'-']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Frequency:\"}),\" \",customer.frequency||'-']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Remarks:\"}),\" \",customer.remarks||'-']}),/*#__PURE__*/_jsx(\"h4\",{className:\"mt-4\",children:\"Sales Records\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table mt-2\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Item\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Payment\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Containers\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Remarks\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:sales.map(s=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:new Date(s.date).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:s.type}),/*#__PURE__*/_jsx(\"td\",{children:s.item}),/*#__PURE__*/_jsx(\"td\",{children:s.quantity}),/*#__PURE__*/_jsxs(\"td\",{children:[\"\\u20B1\",s.totalAmount]}),/*#__PURE__*/_jsx(\"td\",{children:s.paymentMethod}),/*#__PURE__*/_jsx(\"td\",{children:s.status}),/*#__PURE__*/_jsx(\"td\",{children:s.containerIds&&s.containerIds.length>0?s.containerIds.map((c,idx)=>/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(Link,{to:`/inventory/${c._id||c.id}`,children:c.name||c.id||c._id}),idx!==s.containerIds.length-1&&', ']},c._id||c.id)):'-'}),/*#__PURE__*/_jsx(\"td\",{children:s.remarks})]},s._id))})]}),/*#__PURE__*/_jsx(Link,{to:\"/customers\",className:\"btn btn-secondary mt-3\",children:\"Back to Customers\"})]});}export default CustomerProfile;","map":{"version":3,"names":["React","useEffect","useState","axios","useParams","Link","jsx","_jsx","jsxs","_jsxs","CustomerProfile","id","profile","setProfile","fetchProfile","res","get","data","err","console","error","children","customer","lastTransaction","sales","style","padding","name","className","fontSize","Date","createdAt","toLocaleDateString","date","formattedDate","year","month","day","today","setHours","diffTime","diffDays","Math","round","daysAgo","nickname","phone","address","landmark","birthday","frequency","remarks","map","s","type","item","quantity","totalAmount","paymentMethod","status","containerIds","length","c","idx","to","_id"],"sources":["D:/GameProjects/JacksWRS App/frontend/jackswrsapp/src/pages/CustomerProfile.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useParams, Link } from 'react-router-dom';\r\n\r\nfunction CustomerProfile() {\r\n  const { id } = useParams();\r\n  const [profile, setProfile] = useState(null);\r\n\r\nuseEffect(() => {\r\n  const fetchProfile = async () => {\r\n    try {\r\n      const res = await axios.get(`http://localhost:3001/api/customers/${id}/profile`);\r\n      setProfile(res.data);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n  fetchProfile();\r\n}, [id]);\r\n\r\n  if (!profile) return <div>Loading...</div>;\r\n\r\n  const { customer, lastTransaction, sales } = profile;\r\n\r\n  return (\r\n    <div style={{ padding: '20px' }}>\r\n      <h2>\r\n        {customer.name}{\" \"}\r\n        <small className=\"text-muted\" style={{ fontSize: '14px' }}>\r\n          Created: {new Date(customer.createdAt).toLocaleDateString()}\r\n        </small>\r\n      </h2>\r\n\r\n      <p>\r\n        <strong>Last Transaction:</strong>{\" \"}\r\n        {lastTransaction ? (() => {\r\n          const date = new Date(lastTransaction);\r\n          const formattedDate = date.toLocaleDateString('en-US', {\r\n            year: 'numeric',\r\n            month: 'long',\r\n            day: 'numeric'\r\n          });\r\n      \r\n          const today = new Date();\r\n          // Reset time to midnight for accurate day difference\r\n          today.setHours(0,0,0,0);\r\n          date.setHours(0,0,0,0);\r\n      \r\n          const diffTime = today - date;\r\n          const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24));\r\n      \r\n          const daysAgo = diffDays === 0 ? \"today\" : `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;\r\n      \r\n          return `${formattedDate} (${daysAgo})`;\r\n        })() : '-'}\r\n      </p>\r\n      <p><strong>Nickname:</strong> {customer.nickname || '-'}</p>\r\n      <p><strong>Phone:</strong> {customer.phone || '-'}</p>\r\n      <p><strong>Address:</strong> {customer.address || '-'}</p>\r\n      <p><strong>Landmark:</strong> {customer.landmark || '-'}</p>\r\n      <p><strong>Birthday:</strong> {customer.birthday ? new Date(customer.birthday).toLocaleDateString() : '-'}</p>\r\n      <p><strong>Frequency:</strong> {customer.frequency || '-'}</p>\r\n      <p><strong>Remarks:</strong> {customer.remarks || '-'}</p>\r\n\r\n      <h4 className=\"mt-4\">Sales Records</h4>\r\n      <table className=\"table mt-2\">\r\n        <thead>\r\n          <tr>\r\n            <th>Date</th>\r\n            <th>Type</th>\r\n            <th>Item</th>\r\n            <th>Qty</th>\r\n            <th>Total</th>\r\n            <th>Payment</th>\r\n            <th>Status</th>\r\n            <th>Containers</th>\r\n            <th>Remarks</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {sales.map(s => (\r\n            <tr key={s._id}>\r\n              <td>{new Date(s.date).toLocaleDateString()}</td>\r\n              <td>{s.type}</td>\r\n              <td>{s.item}</td>\r\n              <td>{s.quantity}</td>\r\n              <td>â‚±{s.totalAmount}</td>\r\n              <td>{s.paymentMethod}</td>\r\n              <td>{s.status}</td>\r\n              <td>\r\n                {s.containerIds && s.containerIds.length > 0 ? (\r\n                  s.containerIds.map((c, idx) => (\r\n                    <span key={c._id || c.id}>\r\n                      <Link to={`/inventory/${c._id || c.id}`}>\r\n                        {c.name || c.id || c._id}\r\n                      </Link>\r\n                      {idx !== s.containerIds.length - 1 && ', '}\r\n                    </span>\r\n                  ))\r\n                ) : (\r\n                  '-'\r\n                )}\r\n              </td>\r\n              <td>{s.remarks}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n\r\n      <Link to=\"/customers\" className=\"btn btn-secondary mt-3\">Back to Customers</Link>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CustomerProfile;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}